<script type="text/javascript">
  $(document).ready(function() {
    $("#pages a").on("click", function() {
      $.getScript(this.href);
      return false;
    });
    var active = true;
    $('#collapse-init').click(function () {
      if (active) {
        active = false;
        $('.accordion-body').collapse('show');
          $('.accordion-toggle').children().removeClass().addClass("icon-minus");
          $(this).text('Ocultar todos');
      } else {
        active = true;
        $('.accordion-body').collapse('hide');
        $('.accordion-toggle').children().removeClass().addClass("icon-plus");
        $(this).text('Ver todos');
      }
    });

    $('.accor').click(function () {
      if (this.classList.contains("collapsed")){
        this.children[0].className = "icon-minus";
      }else {
        this.children[0].className = "icon-plus";
      }
    });

  });
</script>
<div class="row">
  <div class="span12">
    <%= link_to t('ag2_gest.subscribers.show.all'), controller: "subscribers", action: "show", ifilter: "all", :remote => true %> |
    <%= link_to t('ag2_gest.subscribers.show.pendig_only'), controller: "subscribers", action: "show", ifilter: "pending", :remote => true %> |
    <!-- <%#= link_to t('ag2_gest.subscribers.show.unpaid_only'), controller: "subscribers", action: "show", ifilter: "unpaid", :remote => true %> | -->
    <%= link_to t('ag2_gest.subscribers.show.charged_only'), controller: "subscribers", action: "show", ifilter: "charged", :remote => true %>
    <button id="collapse-init" class="btn btn-mini btn-primary pull-right" style="margin-left:5px;"><%= "Ver todos" %></button>
    <a href="#new-bill" role="button" id="new_bill" class="btn btn-mini btn-primary pull-right <%= 'hide' unless !@subscriber.non_billable %>" style="margin-left:5px;" data-toggle="modal">Nueva factura</a>
  </div>
</div>

<!-- Total bills/invoices -->
<div align="right" class="span11"><h5><b><%= I18n.t("ag2_gest.subscribers.show.total_bills") %>:</b> <%= number_with_precision(@subscriber_bills_total, precision: 2, delimiter: I18n.locale == :es ? "." : ",") %></h5></div>

<div class="row">
  <div class="span1"><b>&nbsp;</b></div> <!-- Space for icon-plus -->
  <div class="span3">
    <b><%= t('activerecord.attributes.subscriber.receipt') %></b>
  </div>
  <div class="span1">
    <b><%= t('activerecord.attributes.commercial_billing.codes') %></b>
  </div>
  <div class="span1" align="center">
    <b><%= t('activerecord.attributes.subscriber.period') %></b>
  </div>
  <div class="span1" align="center">
    <b><%= t('activerecord.attributes.subscriber.date') %></b>
  </div>
  <div class="span1" align="center">
    <b><%= t('activerecord.attributes.invoice.payday_limit') %></b>
  </div>
  <!-- <div class="span2">
    <b><#%= t('activerecord.attributes.subscriber.type') %></b>
  </div> -->
  <div align="right" class="span1">
    <b><%= t('activerecord.attributes.subscriber.total') %></b>
  </div>
  <div class="span2 soft-padding pull-right">
  </div>
</div>
<% @subscriber_bills.each do |bill| %>
  <% if !WaterSupplyContract.billed(bill.bill_id_).nil? %>
    <!-- Contract Bill -->
    <%= render 'bill_contracting_request', :bill => bill %>
  <% else %>
    <!-- Service Bill -->
    <%= render 'bill_reading', :bill => bill %>
  <% end %>
<% end %>
<%= render :partial => '/layouts/pagination', :locals => { :ivar => @subscriber_bills } %>
