<script type="text/javascript">
  $(document).ready(function() {
    // Select2
    $('select.sel2').select2({
      formatNoMatches: function(m) { return '<%= I18n.t("select2.no_matches") %>'; },
      allowClear: true
    });

    $('.date_picker').datepicker({
      format : 'dd/mm/yyyy',
      weekStart : 1
    });

  });
</script>

<%= simple_form_for @reading, :html => {:class => 'form-vertical well'} do |f| %>
  <%= f.error_notification %>
  <%= display_base_errors resource %>

    <div class="row-fluid">
      <%= f.association :project, label: t('activerecord.attributes.reading.project_id'),:required => true, collection: Project.all(order: 'name'), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.name }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

      <%= f.association :billing_period, label: t('activerecord.attributes.reading.billing_period_id'),:required => true, collection: BillingPeriod.all(), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.period }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

      <%= f.association :billing_frequency, label: t('activerecord.attributes.reading.billing_frequency_id'),:required => true, collection: BillingFrequency.all(), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.name }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

    </div>

    <div class="row-fluid">

      <%= f.association :reading_type, label: t('activerecord.attributes.reading.reading_type_id'),:required => true, collection: ReadingType.all(), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.name }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

      <%= f.association :meter, label: t('activerecord.attributes.reading.meter_id'),:required => true, collection: Meter.all(), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.meter_code }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

      <%= f.association :subscriber, label: t('activerecord.attributes.reading.subscriber_id'),:required => true, collection: Subscriber.all(), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.to_label }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

    </div>

    <div class="row-fluid">

      <%= f.association :reading_route, label: t('activerecord.attributes.reading.reading_route_id'),:required => true, collection: ReadingRoute.all(), :input_html => { :class => 'sel2 x-large-text-field' }, label_method: lambda { |st| st.route_code }, value_method: :id, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

      <%= f.input :reading_index, label: t('activerecord.attributes.reading.reading'), :required => true, :autofocus => true, :input_html => { :class => 'x-large-text-field' }, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

      <%= f.input :reading_date, :required => true, :start_year => Time.now.year - 100, :end_year => Time.now.year + 100, :as => :string, :input_html => { :value => (f.object.reading_date.strftime("%d/%m/%Y") if f.object.reading_date), :class => 'mid-text-field date_picker' }, :label_html => { :class => 'form-label' }, wrapper_html: {class: "span4"} %>

    </div>
    <div class="row-fluid">
      <h4>INCIDENCIAS</h4>
      <% ReadingIncidenceType.all.each do |type| %>
        <p>
          <label class="pull-left" style="margin-left: 5px;margin-right:20px" >
            <%= check_box_tag :reading_incidences_ids, type.id, @reading.reading_incidences.map(&:reading_incidence_type).include?(type), :name => 'reading[reading_incidences_ids][]', class: "pull-left" %>
            <%= type.name %>
          <label>
        </p>
      <% end -%>


    </div>

    <%= f.button :submit, :class => 'btn-primary' %>

<% end %>
