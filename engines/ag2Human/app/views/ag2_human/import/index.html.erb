<script>
  $(document).ready(function() {
    //$("#progressbar").css("width", "0%");
    $("#message_area").children().hide();
  });

  jQuery(function($) {
    // when #data_import_btn is clicked
    $("#data_import_btn").click(function() {
      $('#message_area').children().show();
      $('#buttons').children().hide();
      // make a POST call and executes action
      jQuery.getJSON('data_import', function(data) {
        $(".modal-body > p").text(data.DataImport);
        $("#importinfo").modal("show");
        if (data.Result == 'OK') {
          $("#message").html('<%= link_to 'Do you want to see the updated workers?', workers_path %>');
          $("#progressbar").hide();
        }
        else {
          $('#message_area').children().hide();
        }
        $("#data_import_btn").text("Try again");
        $('#buttons').children().show();
      })
      return false;
    });
  })
</script>

<%= render '/layouts/ag2_human/importbreadcrumb' %>
<%= render '/layouts/importinfo' %>

<div class="row">
  <div class="span12">
    <h3 class="import-h3">ag2DataImport</h3>
  </div>
</div>
<div class="row">
  <div class="span8">
    <div class="import-description">
      <h4>Workers Updater</h4>
      <br />
      <p>
        ag2DataImport will add new Workers or update existing ones,
        using external update data. This procedure do not destroy
        any existing Workers data.
      </p>
      <p class="bolded">
        This operation may take a while: Do not interrupt it once starts up!
      </p>
    </div>
  </div>
  <div class="span4 import-box">
    <div align="center">
      <p class="import-caution">
        Caution!
      </p>
      <p>
        This action cannot be undone!
        <br />
        Are you sure to proceed?
      </p>
      <div id="buttons">
        <a href="#" id="data_import_btn" class="btn btn-primary">Yes, go ahead</a>
        <a href="<%= ag2_human.root_path %>" id="exit_btn" class="btn btn-primary">No, thanks</a>
      </div>
      <br />
      <div id="message_area">
        <span id="message">Wait, importing...</span>
        <div id="progressbar" class="bert2-green-progress"></div>
      </div>
    </div>
  </div>
</div>
