report.set_layout tlf: 'reports/office_report', layout_options: { default: true }

report.events.on :page_create do |e|
  # Set page-number.
  e.page.item(:page_no).value(e.page.no)
end
report.events.on :generate do |e|
  e.pages.each do |page|
    # Set total-page-number.
    page.item(:page_count).value(e.report.page_count)
  end
end
    
report.start_new_page
report.page.values printed_at: Time.now
report.page.values worker_id: @worker
